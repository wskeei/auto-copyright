<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备详情 | 物联网数据分析</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.0.1"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1.2.0"></script>
    <style>
        :root {
            --primary-color: #0071e3;
            --secondary-color: #2997ff;
            --background-color: #f5f5f7;
            --card-color: #ffffff;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --border-color: #d2d2d7;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-primary);
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .back-button {
            background-color: transparent;
            border: none;
            color: var(--primary-color);
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .back-button:hover {
            text-decoration: underline;
        }

        .device-container {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .card-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 16px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .device-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .device-info-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .info-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .info-value {
            font-weight: 500;
            text-align: right;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 6px;
        }

        .status-active {
            background-color: #34c759;
        }

        .status-inactive {
            background-color: #ff3b30;
        }

        .status-warning {
            background-color: #ff9500;
        }

        .current-readings {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .reading-card {
            background-color: var(--card-color);
            border-radius: 10px;
            padding: 16px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .reading-value {
            font-size: 28px;
            font-weight: 600;
            margin: 8px 0;
            color: var(--primary-color);
        }

        .reading-label {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .chart-container {
            margin-top: 20px;
            height: 300px;
        }

        .time-range-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .time-range-btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background-color: transparent;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .time-range-btn:hover {
            background-color: rgba(0, 113, 227, 0.1);
        }

        .time-range-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .custom-range-selector {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 10px;
        }

        .date-input {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
        }

        .apply-btn {
            padding: 8px 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .hidden {
            display: none;
        }

        .tab-container {
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            font-size: 15px;
            color: var(--text-secondary);
            position: relative;
        }

        .tab.active {
            color: var(--primary-color);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .event-log {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .event-item {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
        }

        .event-time {
            color: var(--text-secondary);
            font-size: 13px;
        }

        .event-message {
            flex-grow: 1;
            margin-left: 15px;
        }

        .event-type {
            font-weight: 500;
            color: var(--primary-color);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>设备详情</h1>
        <button class="back-button">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            返回设备列表
        </button>
    </div>

    <div class="device-container">
        <div class="card">
            <h2 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M19.4 15C19.2669 15.3016 19.227 15.6363 19.2863 15.9606C19.3456 16.2849 19.5006 16.5815 19.7276 16.8085C19.9546 17.0355 20.2512 17.1905 20.5755 17.2498C20.8998 17.3091 21.2345 17.2692 21.5361 17.1361L21.5861 17.1141C21.8877 16.981 22.1406 16.7623 22.3096 16.4888C22.4786 16.2153 22.5549 15.9015 22.5276 15.5879C22.5003 15.2743 22.371 14.9772 22.1589 14.7381C21.9468 14.499 21.6629 14.3304 21.3499 14.2561L19.5559 13.8561C19.2543 13.7818 18.9405 13.8051 18.6549 13.9226C18.3692 14.0401 18.1271 14.2457 17.9641 14.5081L17.0001 16.0001" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M4.60002 15C4.73312 15.3016 4.77302 15.6363 4.71372 15.9606C4.65442 16.2849 4.49942 16.5815 4.27242 16.8085C4.04542 17.0355 3.74882 17.1905 3.42452 17.2498C3.10021 17.3091 2.76553 17.2692 2.46392 17.1361L2.41392 17.1141C2.11231 16.981 1.85941 16.7623 1.69041 16.4888C1.52141 16.2153 1.44512 15.9015 1.47242 15.5879C1.49972 15.2743 1.62902 14.9772 1.84112 14.7381C2.05322 14.499 2.33712 14.3304 2.65012 14.2561L4.44412 13.8561C4.74572 13.7818 5.05952 13.8051 5.34518 13.9226C5.63084 14.0401 5.87292 14.2457 6.03592 14.5081L7.00002 16.0001" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M4.60002 9C4.73312 8.69839 4.77302 8.36371 4.71372 8.03941C4.65442 7.71511 4.49942 7.41851 4.27242 7.19151C4.04542 6.96451 3.74882 6.80951 3.42452 6.75021C3.10021 6.69091 2.76553 6.73081 2.46392 6.86392L2.41392 6.88592C2.11231 7.01902 1.85941 7.23772 1.69041 7.5112C1.52141 7.78469 1.44512 8.09851 1.47242 8.41211C1.49972 8.72571 1.62902 9.02279 1.84112 9.26189C2.05322 9.50099 2.33712 9.66959 2.65012 9.74392L4.44412 10.1439C4.74572 10.2182 5.05952 10.1949 5.34518 10.0774C5.63084 9.95992 5.87292 9.75431 6.03592 9.49192L7.00002 7.99992" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M19.4 9C19.2669 8.69839 19.227 8.36371 19.2863 8.03941C19.3456 7.71511 19.5006 7.41851 19.7276 7.19151C19.9546 6.96451 20.2512 6.80951 20.5755 6.75021C20.8998 6.69091 21.2345 6.73081 21.5361 6.86392L21.5861 6.88592C21.8877 7.01902 22.1406 7.23772 22.3096 7.5112C22.4786 7.78469 22.5549 8.09851 22.5276 8.41211C22.5003 8.72571 22.371 9.02279 22.1589 9.26189C21.9468 9.50099 21.6629 9.66959 21.3499 9.74392L19.5559 10.1439C19.2543 10.2182 18.9405 10.1949 18.6549 10.0774C18.3692 9.95992 18.1271 9.75431 17.9641 9.49192L17 7.99992" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                设备信息
            </h2>
            <div class="device-info-item">
                <span class="info-label">设备名称</span>
                <span class="info-value">温湿度传感器 #A42</span>
            </div>
            <div class="device-info-item">
                <span class="info-label">设备ID</span>
                <span class="info-value">THS-2024-0042</span>
            </div>
            <div class="device-info-item">
                <span class="info-label">设备类型</span>
                <span class="info-value">环境传感器</span>
            </div>
            <div class="device-info-item">
                <span class="info-label">位置</span>
                <span class="info-value">会议室 A</span>
            </div>
            <div class="device-info-item">
                <span class="info-label">固件版本</span>
                <span class="info-value">v2.1.4</span>
            </div>
            <div class="device-info-item">
                <span class="info-label">状态</span>
                <span class="info-value">
                    <span class="status-indicator status-active"></span>
                    在线
                </span>
            </div>
            <div class="device-info-item">
                <span class="info-label">最后活跃</span>
                <span class="info-value">5分钟前</span>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 10H3M16 2V6M8 2V6M10.5 14L12 13V18M10.75 18H13.25M7.8 22H16.2C17.8802 22 18.7202 22 19.362 21.673C19.9265 21.3854 20.3854 20.9265 20.673 20.362C21 19.7202 21 18.8802 21 17.2V8.8C21 7.11984 21 6.27976 20.673 5.63803C20.3854 5.07354 19.9265 4.6146 19.362 4.32698C18.7202 4 17.8802 4 16.2 4H7.8C6.11984 4 5.27976 4 4.63803 4.32698C4.07354 4.6146 3.6146 5.07354 3.32698 5.63803C3 6.27976 3 7.11984 3 8.8V17.2C3 18.8802 3 19.7202 3.32698 20.362C3.6146 20.9265 4.07354 21.3854 4.63803 21.673C5.27976 22 6.11984 22 7.8 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                数据监控
            </h2>
            
            <div class="current-readings">
                <div class="reading-card">
                    <div class="reading-value">23.5°C</div>
                    <div class="reading-label">当前温度</div>
                </div>
                <div class="reading-card">
                    <div class="reading-value">45%</div>
                    <div class="reading-label">当前湿度</div>
                </div>
                <div class="reading-card">
                    <div class="reading-value">3.7V</div>
                    <div class="reading-label">电池电压</div>
                </div>
            </div>

            <div class="time-range-selector">
                <button class="time-range-btn active" data-range="1h">近1小时</button>
                <button class="time-range-btn" data-range="24h">近24小时</button>
                <button class="time-range-btn" data-range="7d">近7天</button>
                <button class="time-range-btn" data-range="custom">自定义范围</button>
            </div>

            <div id="custom-range-selector" class="custom-range-selector hidden">
                <input type="datetime-local" class="date-input" id="start-date">
                <span>至</span>
                <input type="datetime-local" class="date-input" id="end-date">
                <button class="apply-btn" id="apply-custom-range">应用</button>
            </div>

            <div class="tab-container">
                <div class="tabs">
                    <div class="tab active" data-tab="temperature">温度</div>
                    <div class="tab" data-tab="humidity">湿度</div>
                    <div class="tab" data-tab="battery">电池</div>
                    <div class="tab" data-tab="events">事件日志</div>
                </div>
                
                <div class="tab-content active" id="temperature-tab">
                    <div class="chart-container">
                        <canvas id="temperatureChart"></canvas>
                    </div>
                </div>
                
                <div class="tab-content" id="humidity-tab">
                    <div class="chart-container">
                        <canvas id="humidityChart"></canvas>
                    </div>
                </div>
                
                <div class="tab-content" id="battery-tab">
                    <div class="chart-container">
                        <canvas id="batteryChart"></canvas>
                    </div>
                </div>
                
                <div class="tab-content" id="events-tab">
                    <div class="event-log">
                        <div class="event-item">
                            <div class="event-time">10:25:42</div>
                            <div class="event-message"><span class="event-type">温度警报</span> - 温度超过阈值 (25°C)</div>
                        </div>
                        <div class="event-item">
                            <div class="event-time">09:42:15</div>
                            <div class="event-message"><span class="event-type">数据上报</span> - 正常数据上报</div>
                        </div>
                        <div class="event-item">
                            <div class="event-time">08:30:03</div>
                            <div class="event-message"><span class="event-type">设备重启</span> - 固件自动更新完成</div>
                        </div>
                        <div class="event-item">
                            <div class="event-time">07:15:28</div>
                            <div class="event-message"><span class="event-type">连接恢复</span> - 网络连接恢复</div>
                        </div>
                        <div class="event-item">
                            <div class="event-time">06:50:12</div>
                            <div class="event-message"><span class="event-type">连接中断</span> - 网络连接丢失</div>
                        </div>
                        <div class="event-item">
                            <div class="event-time">00:05:37</div>
                            <div class="event-message"><span class="event-type">数据上报</span> - 正常数据上报</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const timeRangeButtons = document.querySelectorAll('.time-range-btn');
            const customRangeSelector = document.getElementById('custom-range-selector');
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            timeRangeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    timeRangeButtons.forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (this.dataset.range === 'custom') {
                        customRangeSelector.classList.remove('hidden');
                    } else {
                        customRangeSelector.classList.add('hidden');
                        updateCharts(this.dataset.range);
                    }
                });
            });
            
            document.getElementById('apply-custom-range').addEventListener('click', function() {
                const startDate = document.getElementById('start-date').value;
                const endDate = document.getElementById('end-date').value;
                
                if (startDate && endDate) {
                    updateCharts('custom', startDate, endDate);
                }
            });
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(`${this.dataset.tab}-tab`).classList.add('active');
                });
            });
            
            function generateData(range) {
                const now = new Date();
                let data = [];
                let count = 24;
                
                if (range === '1h') count = 12;
                else if (range === '24h') count = 24;
                else if (range === '7d') count = 28;
                
                for (let i = 0; i < count; i++) {
                    let timestamp = new Date(now);
                    
                    if (range === '1h') {
                        timestamp.setMinutes(now.getMinutes() - (60 - i * 5));
                    } else if (range === '24h') {
                        timestamp.setHours(now.getHours() - (24 - i));
                    } else if (range === '7d') {
                        timestamp.setDate(now.getDate() - (7 - Math.floor(i / 4)));
                        timestamp.setHours(i % 4 * 6);
                    }
                    
                    data.push({
                        x: timestamp,
                        y: range === 'battery' ? 
                            (3.5 + Math.random() * 0.5).toFixed(1) :
                            range === 'humidity' ?
                            (40 + Math.random() * 20).toFixed(1) :
                            (20 + Math.random() * 8).toFixed(1)
                    });
                }
                
                return data;
            }
            
            function updateCharts(range, startDate, endDate) {
                const tempData = generateData(range);
                const humidityData = generateData(range);
                const batteryData = generateData(range);
                
                temperatureChart.data.datasets[0].data = tempData;
                humidityChart.data.datasets[0].data = humidityData;
                batteryChart.data.datasets[0].data = batteryData;
                
                temperatureChart.update();
                humidityChart.update();
                batteryChart.update();
            }
            
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'time',
                        time: {
                            tooltipFormat: 'HH:mm',
                            displayFormats: {
                                hour: 'HH:mm',
                                day: 'MMM d'
                            }
                        },
                        grid: {
                            display: false
                        }
                    },
                    y: {
                        grid: {
                            color: '#f0f0f0'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            };
            
            const temperatureChart = new Chart(
                document.getElementById('temperatureChart'),
                {
                    type: 'line',
                    data: {
                        datasets: [{
                            data: generateData('24h'),
                            borderColor: '#0071e3',
                            backgroundColor: 'rgba(0, 113, 227, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            pointRadius: 0,
                            pointHoverRadius: 5
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                ...chartOptions.scales.y,
                                title: {
                                    display: true,
                                    text: '温度 (°C)'
                                }
                            }
                        }
                    }
                }
            );
            
            const humidityChart = new Chart(
                document.getElementById('humidityChart'),
                {
                    type: 'line',
                    data: {
                        datasets: [{
                            data: generateData('24h'),
                            borderColor: '#0071e3',
                            backgroundColor: 'rgba(0, 113, 227, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            pointRadius: 0,
                            pointHoverRadius: 5
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                ...chartOptions.scales.y,
                                title: {
                                    display: true,
                                    text: '湿度 (%)'
                                }
                            }
                        }
                    }
                }
            );
            
            const batteryChart = new Chart(
                document.getElementById('batteryChart'),
                {
                    type: 'line',
                    data: {
                        datasets: [{
                            data: generateData('24h'),
                            borderColor: '#0071e3',
                            backgroundColor: 'rgba(0, 113, 227, 0.1)',
                            borderWidth: 2,
                            tension: 0.3,
                            pointRadius: 0,
                            pointHoverRadius: 5
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            ...chartOptions.scales,
                            y: {
                                ...chartOptions.scales.y,
                                title: {
                                    display: true,
                                    text: '电压 (V)'
                                }
                            }
                        }
                    }
                }
            );
            
            const now = new Date();
            const defaultEndDate = new Date(now);
            const defaultStartDate = new Date(now);
            defaultStartDate.setDate(now.getDate() - 1);
            
            document.getElementById('start-date').valueAsDate = defaultStartDate;
            document.getElementById('end-date').valueAsDate = defaultEndDate;
        });
    </script>
</body>
</html>