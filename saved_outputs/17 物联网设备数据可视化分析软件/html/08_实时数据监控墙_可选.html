<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>物联网设备数据可视化分析</title>
    <style>
        :root {
            --primary-color: #0071e3;
            --primary-light: #2997ff;
            --background: #f5f7fa;
            --card-bg: #ffffff;
            --text-primary: #1d1d1f;
            --text-secondary: #86868b;
            --border-color: #d2d2d7;
            --success-color: #34c759;
            --warning-color: #ff9500;
            --danger-color: #ff3b30;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: var(--background);
            color: var(--text-primary);
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .header h1 {
            font-weight: 600;
            font-size: 24px;
            color: var(--primary-color);
        }

        .header-controls {
            display: flex;
            gap: 16px;
        }

        select, button {
            padding: 8px 16px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg);
            color: var(--text-primary);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        select:focus, button:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 113, 227, 0.1);
        }

        button.primary {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }

        button.primary:hover {
            background-color: var(--primary-light);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-weight: 500;
            font-size: 16px;
            color: var(--text-primary);
        }

        .card-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
        }

        .status-normal {
            background-color: rgba(52, 199, 89, 0.1);
            color: var(--success-color);
        }

        .status-warning {
            background-color: rgba(255, 149, 0, 0.1);
            color: var(--warning-color);
        }

        .status-danger {
            background-color: rgba(255, 59, 48, 0.1);
            color: var(--danger-color);
        }

        .card-value {
            font-size: 32px;
            font-weight: 600;
            margin: 12px 0;
            color: var(--primary-color);
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .trend-up {
            color: var(--danger-color);
        }

        .trend-down {
            color: var(--success-color);
        }

        .chart-container {
            height: 100px;
            margin-top: 12px;
        }

        .device-selector {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .device-selector-header {
            font-weight: 500;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .device-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        .device-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background-color: var(--background);
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .device-item:hover {
            background-color: #e8e8ed;
        }

        .device-item.active {
            background-color: var(--primary-color);
            color: white;
        }

        .device-item .indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .indicator-normal {
            background-color: var(--success-color);
        }

        .indicator-warning {
            background-color: var(--warning-color);
        }

        .indicator-danger {
            background-color: var(--danger-color);
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .data-table th, .data-table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            font-weight: 500;
            color: var(--text-secondary);
        }

        .refresh-info {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: right;
            margin-top: 8px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>实时数据监控墙</h1>
        <div class="header-controls">
            <select id="view-mode">
                <option value="compact">紧凑视图</option>
                <option value="detailed" selected>详细视图</option>
                <option value="fullscreen">全屏模式</option>
            </select>
            <select id="refresh-rate">
                <option value="2000">2秒刷新</option>
                <option value="5000" selected>5秒刷新</option>
                <option value="10000">10秒刷新</option>
            </select>
            <button class="primary" id="export-btn">导出数据</button>
        </div>
    </div>

    <div class="device-selector">
        <div class="device-selector-header">选择监控设备</div>
        <div class="device-list" id="device-list">
            <!-- 设备列表将通过JS动态生成 -->
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="card">
            <div class="card-header">
                <div class="card-title">温度传感器 - 车间A</div>
                <div class="card-status status-normal">正常</div>
            </div>
            <div class="card-value">23.5°C</div>
            <div class="card-meta">
                <span>当前值</span>
                <span class="trend-down">↓ 0.3°C</span>
            </div>
            <div class="chart-container" id="chart-temp-a"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title">湿度传感器 - 仓库B</div>
                <div class="card-status status-warning">注意</div>
            </div>
            <div class="card-value">68.2%</div>
            <div class="card-meta">
                <span>当前值</span>
                <span class="trend-up">↑ 2.1%</span>
            </div>
            <div class="chart-container" id="chart-humidity-b"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title">电力消耗 - 主生产线</div>
                <div class="card-status status-normal">正常</div>
            </div>
            <div class="card-value">4.8 kW</div>
            <div class="card-meta">
                <span>当前值</span>
                <span class="trend-down">↓ 0.2 kW</span>
            </div>
            <div class="chart-container" id="chart-power-main"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <div class="card-title">气压传感器 - 实验室</div>
                <div class="card-status status-danger">警报</div>
            </div>
            <div class="card-value">98.3 kPa</div>
            <div class="card-meta">
                <span>当前值</span>
                <span class="trend-up">↑ 1.5 kPa</span>
            </div>
            <div class="chart-container" id="chart-pressure-lab"></div>
        </div>

        <div class="card full-width">
            <div class="card-header">
                <div class="card-title">设备状态概览</div>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>设备名称</th>
                        <th>位置</th>
                        <th>当前值</th>
                        <th>状态</th>
                        <th>最后更新</th>
                    </tr>
                </thead>
                <tbody id="device-status-table">
                    <!-- 表格内容将通过JS动态生成 -->
                </tbody>
            </table>
            <div class="refresh-info">数据每5秒自动刷新</div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // 设备数据
        const devices = [
            { id: 'temp-a', name: '温度传感器', location: '车间A', type: 'temperature', unit: '°C', value: 23.5, status: 'normal', trend: -0.3 },
            { id: 'humidity-b', name: '湿度传感器', location: '仓库B', type: 'humidity', unit: '%', value: 68.2, status: 'warning', trend: 2.1 },
            { id: 'power-main', name: '电力消耗', location: '主生产线', type: 'power', unit: 'kW', value: 4.8, status: 'normal', trend: -0.2 },
            { id: 'pressure-lab', name: '气压传感器', location: '实验室', type: 'pressure', unit: 'kPa', value: 98.3, status: 'danger', trend: 1.5 },
            { id: 'flow-1', name: '水流传感器', location: '冷却系统', type: 'flow', unit: 'L/min', value: 12.7, status: 'normal', trend: 0.1 },
            { id: 'co2-1', name: 'CO2传感器', location: '办公区', type: 'co2', unit: 'ppm', value: 450, status: 'normal', trend: -5 },
            { id: 'vibration-1', name: '振动传感器', location: '电机组', type: 'vibration', unit: 'mm/s', value: 2.3, status: 'warning', trend: 0.4 },
            { id: 'light-1', name: '光照传感器', location: '走廊', type: 'light', unit: 'lux', value: 320, status: 'normal', trend: 0 }
        ];

        // 图表实例
        const charts = {};

        // 初始化设备列表
        function initDeviceList() {
            const deviceListEl = document.getElementById('device-list');
            deviceListEl.innerHTML = '';
            
            devices.forEach(device => {
                const deviceEl = document.createElement('div');
                deviceEl.className = `device-item ${device.id === 'temp-a' ? 'active' : ''}`;
                deviceEl.dataset.id = device.id;
                
                const indicatorClass = `indicator-${device.status}`;
                deviceEl.innerHTML = `
                    <span class="indicator ${indicatorClass}"></span>
                    ${device.name} - ${device.location}
                `;
                
                deviceEl.addEventListener('click', () => {
                    document.querySelectorAll('.device-item').forEach(el => el.classList.remove('active'));
                    deviceEl.classList.add('active');
                });
                
                deviceListEl.appendChild(deviceEl);
            });
        }

        // 初始化设备状态表格
        function initDeviceStatusTable() {
            const tableBody = document.getElementById('device-status-table');
            tableBody.innerHTML = '';
            
            devices.forEach(device => {
                const statusText = {
                    normal: '正常',
                    warning: '注意',
                    danger: '警报'
                }[device.status];
                
                const statusClass = {
                    normal: 'status-normal',
                    warning: 'status-warning',
                    danger: 'status-danger'
                }[device.status];
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${device.name}</td>
                    <td>${device.location}</td>
                    <td>${device.value} ${device.unit}</td>
                    <td><span class="${statusClass}">${statusText}</span></td>
                    <td>刚刚</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // 初始化图表
        function initCharts() {
            // 温度传感器图表
            initChart('chart-temp-a', 'line', generateRandomData(23.5, 1.5, 10), '#0071e3');
            
            // 湿度传感器图表
            initChart('chart-humidity-b', 'line', generateRandomData(68.2, 3, 10), '#34c759');
            
            // 电力消耗图表
            initChart('chart-power-main', 'line', generateRandomData(4.8, 0.5, 10), '#ff9500');
            
            // 气压传感器图表
            initChart('chart-pressure-lab', 'line', generateRandomData(98.3, 2, 10), '#ff3b30');
        }

        // 初始化单个图表
        function initChart(chartId, type, data, color) {
            const ctx = document.getElementById(chartId).getContext('2d');
            
            charts[chartId] = new Chart(ctx, {
                type: type,
                data: {
                    labels: Array.from({length: 10}, (_, i) => i + 1),
                    datasets: [{
                        data: data,
                        borderColor: color,
                        backgroundColor: 'transparent',
                        borderWidth: 2,
                        pointRadius: 0,
                        tension: 0.4,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            display: false
                        },
                        y: {
                            display: false,
                            suggestedMin: Math.min(...data) - 2,
                            suggestedMax: Math.max(...data) + 2
                        }
                    }
                }
            });
        }

        // 生成随机数据
        function generateRandomData(baseValue, range, count) {
            return Array.from({length: count}, () => 
                baseValue + (Math.random() * range * 2 - range)
            );
        }

        // 更新数据
        function updateData() {
            // 更新设备数据
            devices.forEach(device => {
                const change = (Math.random() - 0.5) * 2;
                device.value = parseFloat((device.value + change).toFixed(2));
                device.trend = parseFloat((device.trend + (Math.random() - 0.5) * 0.5).toFixed(1));
            });
            
            // 更新卡片显示
            updateCard('temp-a', '23.5°C');
            updateCard('humidity-b', '68.2%');
            updateCard('power-main', '4.8 kW');
            updateCard('pressure-lab', '98.3 kPa');
            
            // 更新图表数据
            updateChart('chart-temp-a', generateRandomData(devices[0].value, 1.5, 10));
            updateChart('chart-humidity-b', generateRandomData(devices[1].value, 3, 10));
            updateChart('chart-power-main', generateRandomData(devices[2].value, 0.5, 10));
            updateChart('chart-pressure-lab', generateRandomData(devices[3].value, 2, 10));
            
            // 更新表格
            initDeviceStatusTable();
        }

        // 更新卡片显示
        function updateCard(deviceId, value) {
            const device = devices.find(d => d.id === deviceId);
            if (!device) return;
            
            const card = document.querySelector(`.card:has([id^="chart-${deviceId}"])`);
            if (!card) return;
            
            // 更新值
            const valueEl = card.querySelector('.card-value');
            valueEl.textContent = `${device.value} ${device.unit}`;
            
            // 更新趋势
            const trendEl = card.querySelector('.trend-up, .trend-down');
            if (trendEl) {
                trendEl.textContent = `${device.trend > 0 ? '↑' : '↓'} ${Math.abs(device.trend)}${device.unit}`;
                trendEl.className = device.trend > 0 ? 'trend-up' : 'trend-down';
            }
            
            // 更新状态
            const statusEl = card.querySelector('.card-status');
            if (statusEl) {
                const statusText = {
                    normal: '正常',
                    warning: '注意',
                    danger: '警报'
                }[device.status];
                
                statusEl.className = `card-status status-${device.status}`;
                statusEl.textContent = statusText;
            }
        }

        // 更新图表数据
        function updateChart(chartId, newData) {
            if (charts[chartId]) {
                charts[chartId].data.datasets[0].data = newData;
                charts[chartId].update();
            }
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            initDeviceList();
            initDeviceStatusTable();
            initCharts();
            
            // 设置定时刷新
            const refreshRateSelect = document.getElementById('refresh-rate');
            let refreshInterval = setInterval(updateData, 5000);
            
            refreshRateSelect.addEventListener('change', () => {
                clearInterval(refreshInterval);
                refreshInterval = setInterval(updateData, parseInt(refreshRateSelect.value));
                
                // 更新刷新信息
                const refreshInfo = document.querySelector('.refresh-info');
                if (refreshInfo) {
                    const seconds = parseInt(refreshRateSelect.value) / 1000;
                    refreshInfo.textContent = `数据每${seconds}秒自动刷新`;
                }
            });
            
            // 导出按钮
            document.getElementById('export-btn').addEventListener('click', () => {
                alert('数据导出功能将在浏览器下载CSV文件');
            });
            
            // 视图模式切换
            document.getElementById('view-mode').addEventListener('change', (e) => {
                if (e.target.value === 'fullscreen') {
                    document.documentElement.requestFullscreen();
                }
            });
        });
    </script>
</body>
</html>